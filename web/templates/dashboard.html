{% extends "base.html" %}

{% block content %}
<div class="kpi-row">
    <div class="kpi-card">
        <div class="kpi-icon kpi-icon-mercury">
            <img src="https://play-lh.googleusercontent.com/Dz9FjvMNDpuvUOsHsbUrbCPpDbkcyuUPa04o9ozdADTih2Gri6nH5aBg6sqsMLi8ZQ" alt="Mercury" width="36" height="36" style="border-radius:8px;">
        </div>
        <div class="kpi-info">
            <div class="kpi-label">Mercury Balance</div>
            <div class="kpi-value" id="kpi-mercury">—</div>
        </div>
    </div>
    <div class="kpi-card">
        <div class="kpi-icon">
            <img src="https://images.stripeassets.com/fzn2n1nzq965/HTTOloNPhisV9P4hlMPNA/cacf1bb88b9fc492dfad34378d844280/Stripe_icon_-_square.svg" alt="Stripe" width="36" height="36" style="border-radius:8px;">
        </div>
        <div class="kpi-info">
            <div class="kpi-label">Stripe Balance</div>
            <div class="kpi-value" id="kpi-stripe">—</div>
        </div>
    </div>
</div>

<div class="chart-container">
    <div id="in-vs-out-chart" class="chart"></div>
</div>
<div class="chart-container">
    <div id="profit-margin-chart" class="chart-medium"></div>
</div>
<div class="chart-container">
    <div id="spend-by-category-chart" class="chart"></div>
</div>

<div class="chart-row">
    <div class="chart-container chart-half">
        <div id="revenue-by-client-chart" class="chart-fixed"></div>
    </div>
    <div class="chart-container chart-half">
        <div id="concentration-risk-chart" class="chart-fixed"></div>
    </div>
</div>

<div class="chart-container" style="position:relative;">
    <button id="remind-all-btn" class="btn-remind-all" onclick="remindAllOverdue()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
            <polyline points="22,6 12,13 2,6"/>
        </svg>
        <span>Remind All Overdue</span>
    </button>
    <div id="expected-revenue-chart" class="chart-fixed-tall"></div>
</div>

<div class="chart-container">
    <div id="days-to-pay-chart" class="chart-fixed"></div>
</div>

<!-- Spend detail drill-down modal -->
<div id="spend-detail-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <button class="modal-close" id="modal-close-btn">&times;</button>
        <div id="spend-detail-chart" style="width:100%;height:100%;"></div>
    </div>
</div>

<!-- Invoice detail drill-down modal -->
<div id="invoice-detail-modal" class="modal-overlay" style="display:none;">
    <div class="modal-content modal-content-wide">
        <button class="modal-close" id="invoice-modal-close-btn">&times;</button>
        <h2 id="invoice-modal-title" class="modal-title">Open Invoices</h2>
        <div id="invoice-table-container" class="invoice-table-container">
            <table class="invoice-table">
                <thead>
                    <tr>
                        <th>Invoice #</th>
                        <th>Amount Due</th>
                        <th>Due Date</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="invoice-table-body"></tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('web.static', filename='js/dashboard.js') }}"></script>
{% endblock %}
